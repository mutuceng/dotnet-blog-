@model PostCreateViewModel

<head>
    <link rel="stylesheet" href="~/css/blogs/blog-create.css" asp-append-version="true" />
</head>
<div class="blog-create container">
    <div class="form-group col-10 mb-2">
        <label asp-for="Title" class="control-label"></label>
        <input asp-for="Title" class="form-control" />
        <span asp-validation-for="Title" class="text-danger"></span>
    </div>
    
    <div class="form-group col-10 mb-2">
        <label asp-for="Content" class="control-label"></label>
        <textarea asp-for="Content" class="form-control"></textarea>
        <span asp-validation-for="Content" class="text-danger"></span>
    </div>
    
    <div class="form-group col-5 mb-2">
        <label asp-for="PostImage" class="control-label"></label>
        <input asp-for="PostImage" class="form-control" type="file" />
        <span asp-validation-for="PostImage" class="text-danger"></span>
    </div>
    
    
    <div class="tag-group mt-4 mb-4">
        <!-- Birincil Etiket (Primary Tag) -->
        <div class="form-group col-5">
            <label asp-for="PrimaryTagName" class="control-label"></label>
            <select asp-for="PrimaryTagName" class="form-control" asp-items="@(new MultiSelectList(Model.Tags))">
                <option value="">Bir etiket seçin</option>
            </select>
            <span asp-validation-for="PrimaryTagName" class="text-danger"></span>
        </div>
        
        <!-- Etiketler (Tags) -->
        <div class="form-group col-5">
            <div id="selectedOptions">
                
            </div>
            
            <label asp-for="Tags" class="control-label"></label>
            <select id="secimler" asp-for="Tags" class="form-control" asp-items="@(new MultiSelectList(Model.Tags))" multiple>
            </select>
            <span asp-validation-for="Tags" class="text-danger"></span>
        </div>
    </div>
    
    <button type="submit" class="publish-btn btn-primary">Yayınla</button>
</div>

@section Scripts
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/7.3.0/tinymce.min.js" integrity="sha512-RUZ2d69UiTI+LdjfDCxqJh5HfjmOcouct56utQNVRjr90Ea8uHQa+gCxvxDTC9fFvIGP+t4TDDJWNTRV48tBpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        tinymce.init({
            selector:'#Content'
        });


        const selectElement = document.getElementById('secimler');
        const selectedOptionsDiv = document.getElementById('selectedOptions');
        const selectedValues = new Set(); // Aynı öğenin tekrar eklenmesini önlemek için Set kullanıyoruz

        // Select kutusundaki değişiklikleri dinle
        selectElement.addEventListener('dblclick', function() {
            const selectedOptionText = selectElement.options[selectElement.selectedIndex].text;
            const selectedOptionValue = selectElement.value;

            // Eğer seçenek daha önce seçilmişse ekleme
            if (!selectedValues.has(selectedOptionValue)) {
                selectedValues.add(selectedOptionValue);

                // Yeni kutu oluştur
                const box = document.createElement('div');
                box.className = 'selected-box';
                box.innerHTML = `${selectedOptionText} <span class="remove-btn">&times;</span>`;

                // Kutuya çarpı işareti tıklama olayını ekle
                box.querySelector('.remove-btn').addEventListener('click', function() {
                    selectedValues.delete(selectedOptionValue); // Seçim set'ten kaldırılıyor
                    box.remove(); // Kutu siliniyor
                });

                // Kutu div'e ekle
                selectedOptionsDiv.appendChild(box);
            }
        });
    </script>
}

